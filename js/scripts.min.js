var __WPAS={FORM:"#wp-advanced-search.wpas-ajax-enabled",CONTAINER:"#wpas-results",INNER:"#wpas-results-inner",DEBUG_CONTAINER:"#wpas-debug",PAGE_FIELD:"#wpas-paged",FORM_ID:"",KEY_PREFIX:"wpasInstance_",HASH:"",STORAGE_KEY:function(){return this.KEY_PREFIX+this.FORM_ID}};jQuery(document).ready(function(t){function e(e){p(1);var a=t(e).serialize();A(a),t(__WPAS.INNER).empty(),n(a,S)}function n(t,e){g.hideButton(),g.showImage(),jQuery.ajax({type:"POST",url:WPAS_Ajax.ajaxurl,data:{action:"wpas_ajax_load",page:e,form_data:t},success:function(t,e,n){response=JSON.parse(t),setTimeout(function(){c(__WPAS.INNER,response.results),g.hideImage(),h(__WPAS.DEBUG_CONTAINER,response.debug),S=response.current_page;var t=response.max_page;f("Current Page: "+S+", Max Page: "+t),0==t||S==t?g.hideButton():g.showButton(),window.location.hash=__WPAS.HASH,a(),d()},b)},error:function(t,e,n){console.log(n)}})}function a(){var t={request:REQUEST_DATA,form:s(),results:o(),page:S};t=JSON.stringify(t),localStorage.setItem(__WPAS.STORAGE_KEY(),t)}function i(e,n){var a=t(n).attr("name"),i=t(n).val();return void 0===e[a]&&(e[a]=[]),t(n).is(":checked")&&e[a].push(i),e}function s(){var e={};return t(__WPAS.FORM).find(":input").not(":button, :submit, :reset").each(function(){"checkbox"==t(this).attr("type")?e=i(e,this):e[t(this).attr("name")]=t(this).val()}),e}function o(){return t(__WPAS.CONTAINER).html()}function r(e){t(__WPAS.FORM).find(":input").not(":button, :submit, :reset").each(function(){var n=e[t(this).attr("name")];"checkbox"==t(this).attr("type")?n.indexOf(t(this).val())>=0?t(this).prop("checked",!0):t(this).prop("checked",!1):t(this).val(n)})}function u(e){t(__WPAS.CONTAINER).html(e)}function _(){t(__WPAS.FORM).addClass("wpas-locked"),t(__WPAS.FORM).find("input:submit").attr("disabled","disabled")}function l(){return t(__WPAS.FORM).hasClass("wpas-locked")}function d(){t(__WPAS.FORM).removeClass("wpas-locked"),t(__WPAS.FORM).find("input:submit").removeAttr("disabled")}function c(e,n){t(e).append(n)}function h(e,n){t(e).html(n)}function p(e){S=e,t(__WPAS.PAGE_FIELD).val(e)}function A(t){REQUEST_DATA=t}function f(t){m&&console.log("WPAS: "+t)}__WPAS.FORM_ID=t("#wpas-id").val(),__WPAS.HASH=t(__WPAS.FORM).data("ajax-url-hash");var S=1;if(t("form.wpas-autosubmit :input").change(function(){t(this).parents("form").submit()}),t("button.wpas-clear").click(function(e){e.preventDefault(),t(this).parents("form").find(":input").not(":button, :submit, :reset, :hidden").val("").removeAttr("checked").removeAttr("selected"),t(this).parents("form.wpas-autosubmit").each(function(){return t(this).submit(),!1})}),t("input.wpas-reset").click(function(e){e.preventDefault(),t(this).parents("form")[0].reset(),t(this).parents("form.wpas-autosubmit").each(function(){return t(this).submit(),!1})}),0==t(__WPAS.FORM).length)return void f("No AJAX-enabled WPAS search form detected on page.");if(0==t(__WPAS.CONTAINER).length)return void f("No container with ID #wpas-results found on page.  Results cannot be shown");var m=!!t(__WPAS.FORM).hasClass("wpas-debug-enabled"),P=!!t(__WPAS.FORM).data("ajax-show-default"),b=m?500:0;if(m&&0==t(__WPAS.DEBUG_CONTAINER).length)return void f("WPAS_DEBUG is enabled but no container with ID #wpas-debug was found on this page.  Debug information cannot be shown.");var g={container:"wpas-load",load_btn:"wpas-load-btn",load_btn_text:"",load_img:"wpas-loading-img",load_img_url:"",init:function(e){this.load_btn_text=t(e).data("ajax-button"),this.load_img_url=t(e).data("ajax-loading"),t(__WPAS.CONTAINER).append(this.create())},create:function(){var t="<div id='wpas-load'>";return t+="<div id='"+this.load_img+"' style='display:none;'></div>",t+="<div><button id='"+this.load_btn+"' style='display:none;'>"+this.load_btn_text+"</button></div>",t+="</div>"},showButton:function(){t("#"+this.load_btn).addClass("active").show()},hideButton:function(){t("#"+this.load_btn).removeClass("active").hide()},showImage:function(){t("#"+this.load_img).show()},hideImage:function(){t("#"+this.load_img).hide()}};t(__WPAS.CONTAINER).append("<div id='wpas-results-inner'></div>"),g.init(__WPAS.FORM);var v=null;window.location.hash.slice(1)==__WPAS.HASH&&(v=JSON.parse(localStorage.getItem("wpasInstance_"+__WPAS.FORM_ID))),null!=v?(f("localStorage found"),function(){var t=localStorage.getItem(__WPAS.STORAGE_KEY());null!=(t=JSON.parse(t))&&(t.form&&r(t.form),t.results&&u(t.results),t.page&&p(t.page),t.request&&A(t.request))}()):(p(1),A(t(__WPAS.FORM).serialize())),0!=t(__WPAS.CONTAINER).length&&(null!=v?t(__WPAS.CONTAINER).html(v.results):P&&n(t(__WPAS.FORM).serialize(),S)),t(__WPAS.FORM).submit(function(t){t.preventDefault(),l()||(_(),e(this))}),t(document).on("click","#"+g.load_btn+".active",function(t){p(parseInt(S)+1),n(REQUEST_DATA,S)})});